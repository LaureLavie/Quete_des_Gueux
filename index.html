<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./style.css" />
    <script type="module" src="./map.js" defer></script>
    <script type="module" src="./script.js" defer></script>
    <title>🎻 La Quête des Gueux 🎻</title>
  </head>
  <body>
    <div id="intro-screen" class="intro-screen">
      <div class="intro-content">
        <h1>🎻 La Quête des Gueux 🎻</h1>
        <p>
          "Oyez, Oyez, tas de gueux et chevaliers à la ramasse !<br /><br />
          Le roi Arthur, ce grand benêt couronné, s'est fait refiler par la Dame
          du Lac une mission aussi tordue qu'une jambe de pouilleux :<br />
          Dégoter un trésor miteux, planqué dans un labyrinthe qui pue la pisse
          de troll et la sueur de gueux.<br /><br />
          Votre job ? Gribouiller la carte du royaume, dénicher l'entrée du
          bourbier, et guider Arthur, dont le sens de l'orientation rivalise
          avec celui d'un poivrot sous champignons hallucinogènes.<br />
          Seuls les cerveaux affûtés, capables de dompter les algorithmes et de
          survivre à la tentation d'aller se rincer le gosier dans la première
          taverne,<br />
          réussiront à en sortir vivant.<br /><br />
          Si, par un miracle, vous mettez la main sur le magot... ramenez-le au
          roi Arthur (ou planquez-le, on dira rien).<br />
          Sinon, direction les latrines, avec les rats, les poux, et la légende
          du chevalier qui a glissé sur une bouse."
        </p>
        <button class="btn" onclick="showMap()">
          Commencer la Quête des gueux
        </button>
      </div>
    </div>

    <div id="map-screen" class="map-screen">
      <div class="map-content">
        <h2>🗺️ Royaume de Kaamelott</h2>
        <p>
          Trouvez les 3 points de passage pour accéder au labyrinthe Maze'Lott !
        </p>
        <div id="mapDiv">
          <img
            src="./royaume.png"
            svg
            width="80%"
            viewBox="0 0 100 700"
            style="object-fit: center"
          />
          <!-- Arrière-plan de la carte -->
          <rect
            width="100"
            height="700"
            fill="#f4e4bc"
            stroke="#8b4513"
            stroke-width="4"
          />

          <!-- Contours de l'île -->
          <path
            d="M100,150 Q200,100 300,120 Q400,90 500,130 Q600,110 650,160 Q700,200 680,300 Q650,400 600,450 Q500,480 400,470 Q300,490 200,460 Q150,400 120,350 Q80,250 100,150 Z"
            fill="#e8d5b7"
            stroke="#8b4513"
            stroke-width="2"
          />
        </div>
        <div id="map-status">
          Points de passage trouvés: <span id="waypoints-found">0</span>/3
        </div>
      </div>
    </div>

    <div class="message-popup" id="messagePopup"></div>

    <div class="header">
      <h1>🏰 Maze'Lott - Quête des Gueux 🏰</h1>
      <p>"Quête de bouseux pour un Trésor de Pouilleux !"</p>
    </div>
    <div class="controls">
      <div class="size-controls">
        <label>Largeur:</label>
        <input type="number" id="width" value="25" min="10" max="50" />
        <label>Hauteur:</label>
        <input type="number" id="height" value="25" min="10" max="50" />
      </div>
      <button class="btn" onclick="generateMaze()">🗝️ Nouveau Maze'Lott</button>
      <button class="btn" onclick="showOptimalPath()">
        🗺️ Chemin optimal pour Gueux
      </button>
      <button class="btn" onclick="resetGame()">
        🔄 Recommence ! C'est le bordel, chef !
      </button>
    </div>
    <div class="game-container">
      <div class="maze-container">
        <div id="maze" class="maze"></div>
      </div>
      <div class="info-panel">
        <h3>⚔️ Grimoire du Bouseux ⚔️</h3>
        <div class="legend">
          <div class="legend-item">
            <div class="legend-color wall"></div>
            <span>Murs crasseux</span>
          </div>
          <div class="legend-item">
            <div class="legend-color path"></div>
            <span>Chemins miteux</span>
          </div>
          <div class="legend-item">
            <div class="legend-color start">🏰</div>
            <span>Taudis de départ</span>
          </div>
          <div class="legend-item">
            <div class="legend-color exit">🚪</div>
            <span>Sortie vers la liberté</span>
          </div>
          <div class="legend-item">
            <div class="legend-color path">💰</div>
            <span>Butin planqué (invisible)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color path">🗺️</div>
            <span>Indices de pouilleux (invisibles)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color player">👑</div>
            <span>Votre misérable personne</span>
          </div>
        </div>
        <div class="controls-info">
          <h4>🎮 Grimoire du Bouseux</h4>
          <p>⌨️ Clavier : Traîner vos guêtres</p>
          <p>🖱️ Souris : Déplacer votre carcasse</p>
          <p>🗺️ 5 indices de bouseux vous guident</p>
          <p>🎯 But : Choper le butin et se barrer !</p>
        </div>
        <div class="stats" id="stats">
          <div><strong>🏰 Quête des Pouilleux en cours...</strong></div>
          <div>📍 Position: <span id="position">Taudis</span></div>
          <div>👣 Pas du cul-terreux: <span id="steps">0</span></div>
          <div>🗺️ Waypoints trouvés: <span id="waypoints">0</span></div>
          <div>💰 Magot: <span id="treasure-status">Que dalle !</span></div>
          <div>🏆 État: <span id="status">En galère</span></div>
        </div>
      </div>
    </div>
    <div class="game-over" id="gameOver">
      <h2>🎉 Bravo Bouseux ! 🎉</h2>
      <p>T'as chopé le butin et t'es sorti de ce bourbier !</p>
      <p>Pas de la carcasse: <span id="final-steps"></span></p>
      <p>Waypoints découverts: <span id="final-waypoints"></span>/5</p>
      <button class="btn" onclick="closeGameOver()">Continue à Glander</button>
    </div>
  </body>
</html>
